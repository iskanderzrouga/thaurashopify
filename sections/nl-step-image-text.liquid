<div class="pr-5 pl-10 py-12 md:py-[80px]">
  <div class="max-w-[1134px] mx-auto w-full">
    <h1
      class="relative text-[32px] lg:text-[40px] text-[#7A5EC5] font-bold !leading-tight text-center [&>strong]:whitespace-nowrap mb-5"
    >
      {{ section.settings.heading }}
    </h1>

    {% if section.settings.description != blank %}
      <div class="text-[##070E15] text-[16px] lg:text-[20px] font-normal !leading-tight text-center mb-10 md:mb-16">
        {{ section.settings.description }}
      </div>
    {% endif %}

    {% for block in section.blocks %}
      <div class="flex {% if block.settings.image_position == 'left' %} flex-col-reverse {% else %} flex-col {% endif %} md:grid md:grid-cols-2 border-l-[4px] border-solid border-[#252726] md:border-none max-md:pl-[30px]">
        {% if block.settings.image_position == 'left' %}
          <div class="px-1 md:px-4 md:border-r-[4px] md:border-solid md:border-[#252726] py-10 md:pr-[80px] md:-mr-[2px] hidden md:block">
            {% if block.settings.image != blank %}
              {{
                block.settings.image
                | image_url: width: 700
                | image_tag: class: 'w-full rounded-[4px]', sizes: '700px'
              }}
            {% endif %}
          </div>
        {% endif %}

        <div class="px-1 md:px-1 md:py-12 relative">
          <div
            class="rounded-[100px] max-w-[50px] md:max-w-[74px] absolute md:top-12 {% if block.settings.image_position == 'left' %} -left-[55px] md:-left-[37px] {% else %} max-md:-left-[55px] md:-right-[37px] {% endif %}"
          >
            {% if block.settings.icon != blank %}
              {{
                block.settings.icon
                | image_url: width: 74
                | image_tag: class: 'w-full rounded-[100px] max-w-[50px] md:max-w-[74px]', sizes: '74px'
              }}
            {% endif %}
          </div>

          <div class="px-1 {% if block.settings.image_position == 'left' %} md:pl-6 lg:pl-[80px] {% else %} md:pr-6 lg:pr-[80px] {% endif %} flex flex-col gap-5">
            {% if block.settings.heading != blank %}
              <div class="text-[22px] md:text-[32px] font-bold !leading-tight text-[#00754A]">
                {{ block.settings.heading }}
              </div>
            {% endif %}
            {% if block.settings.image != blank %}
              {{
                block.settings.image
                | image_url: width: 700
                | image_tag: class: 'w-full rounded-[4px] block md:hidden', sizes: '700px'
              }}
            {% endif %}
            {% if block.settings.text != blank %}
              <div class="text-[16px] md:text-[20px] font-normal !leading-tight text-[#252726] max-md:pb-[30px]">
                {{ block.settings.text }}
              </div>
            {% endif %}
          </div>
        </div>

        {% if block.settings.image_position == 'right' %}
          <div class="px-1 md:px-4 md:border-l-[4px] md:border-solid md:border-[#252726] py-10 md:pl-[80px] md:-ml-[2px] hidden md:block">
            {{
              block.settings.image
              | image_url: width: 700
              | image_tag: class: 'w-full rounded-[4px]', sizes: '700px'
            }}
          </div>
        {% endif %}
      </div>
    {% endfor %}

    <div>
      {% if section.settings.button_label != blank %}
        <div class="max-w-[420px] w-full md:w-fit mx-auto px-[10px]">
          {% if section.settings.cart_button %}
            {% liquid
              assign product = section.settings.product
              assign product_form_id = 'product-form-' | append: section.id
            %}
            {% render 'sk-add-to-cart-button', section: section, product_form_id: product_form_id, product: product %}
          {% else %}
            <a
              href="{{ section.settings.button_url }}"
              data-scroll-to-section
              class="new-button--primary"
            >
              {{ section.settings.button_label }}
              {%- render 'icon-arrow-right' -%}
            </a>
          {% endif %}
        </div>
      {% endif %}

      {% if section.settings.product_bottom_label != blank %}
        <div
          class="relative mx-auto mt-3 md:mt-4 text-[20px] text-[#fff] font-bold !leading-tight px-4 py-1 flex items-center justify-center text-center bg-[#49AB56] rounded-[50px] w-fit"
        >
          {{ section.settings.product_bottom_label }}
        </div>
      {% endif %}
    </div>
  </div>
</div>

<script>
  function toggleAPImageTextAccordion(accordion) {
    const content = accordion.nextElementSibling;
    accordion.classList.toggle('active');
    content.classList.toggle('hidden');

    const arrow = accordion.querySelector('.accordion-arrow');
    arrow.classList.toggle('rotate-180');
    arrow.classList.toggle('transition-transform');
  }
</script>

{% schema %}
{
  "name": "NL Step Image Text",
  "tag": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "checkbox",
      "id": "cart_button",
      "label": "Use Add to Cart Button",
      "default": false
    },
    {
      "type": "product",
      "id": "product",
      "label": "Product"
    },
    {
      "type": "text",
      "id": "product_bottom_label",
      "label": "Product Bottom Label"
    }
  ],
  "blocks": [
    {
      "type": "row",
      "name": "Row",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "select",
          "id": "image_position",
          "options": [
            {
              "value": "left",
              "label": "Left"
            },
            {
              "value": "right",
              "label": "Right"
            }
          ],
          "default": "left",
          "label": "Image Position"
        },
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon "
        },
        {
          "type": "richtext",
          "id": "text",
          "label": "Text"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "NL Step Image Text"
    }
  ]
}
{% endschema %}

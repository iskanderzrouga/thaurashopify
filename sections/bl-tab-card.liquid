{%- style -%}
  .section-{{ section.id }}-padding {
    padding-top: {{ section.settings.padding_top_m }}px;
    padding-bottom: {{ section.settings.padding_bottom_m }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section.id }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .section-{{ section.id }}-padding .section-main-image {
    border-radius: {{ section.settings.border_radius }}px;
  }

  @media screen and (max-width: 768px) {
    .section-{{ section.id }}-padding .bl-tab-card-dropdown-content {
      display: none;
    }
    .section-{{ section.id }}-padding .bl-tab-card-mobile-parent.active .bl-tab-card-dropdown-content {
      display: flex;
    }
  }
{%- endstyle -%}

<div
  id="{{ section.settings.section_id }}"
  class="section-{{ section.id }}-padding px-5 relative"
  style="background-color: {{ section.settings.bgcolor }};"
>
  {% if section.settings.bg != blank %}
    {{
      section.settings.bg
      | image_url: width: 1920
      | image_tag: class: 'absolute top-0 left-0 w-full h-full object-cover', sizes: '1920px'
    }}
  {% endif %}
  <div class="mx-auto w-full relative" style="max-width: {{ section.settings.max_width }}px;">
    <div class="flex flex-col items-center justify-center gap-6 md:gap-12">
      {% if section.settings.heading != blank %}
        <h2
          class="text-[26px] md:text-[40px] font-bold !leading-tight text-[#000] {% if section.settings.heading_m_center %} max-md:text-center {% endif %} {% if section.settings.heading_d_center %} md:text-center {% endif %}"
          style="color: {{ section.settings.heading_color }};"
        >
          {{ section.settings.heading }}
        </h2>
      {% endif %}

      {% if section.settings.description != blank %}
        <div
          class="text-[17px] md:text-[20px] font-normal !leading-tight text-[#000] {% if section.settings.description_m_center %} max-md:text-center {% endif %} {% if section.settings.description_d_center %} md:text-center {% endif %}"
          style="color: {{ section.settings.description_color }};"
        >
          {{ section.settings.description }}
        </div>
      {% endif %}

      {% assign max_width = section.settings.max_width %}
      {% comment %} {% assign max_width = section.settings.max_width |  divided_by: 2 %} {% endcomment %}
      {% assign max_width_px = max_width | append: 'px' %}
      {% if section.settings.image != blank %}
        {{
          section.settings.image
          | image_url: width: max_width
          | image_tag: class: 'w-full section-main-image', sizes: max_width_px
        }}
      {% endif %}

      <div class="w-full flex flex-col items-center gap-5">
        {% if section.blocks.size > 0 %}
          <div class="hidden md:flex items-center gap-3">
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'row' %}
                  <div class="">
                    {% if block.settings.label != blank %}
                      <div
                        data-id="{{ block.id }}"
                        class="bl-tab-card-tab {% if forloop.first %} active {% endif %} cursor-pointer [&.active]:bg-white [&.active]:text-[#084C25] text-[16px] md:text-[16px] font-bold !leading-tight text-[#fff] border border-[#FFFFFF] rounded-[100px] px-5 py-2"
                      >
                        {{ block.settings.label }}
                      </div>
                    {% endif %}
                  </div>
              {% endcase %}
            {% endfor %}
          </div>
          <div class="flex w-full flex-col gap-5">
            {% for block in section.blocks %}
              {% case block.type %}
                {% when 'row' %}
                  <div
                    data-id="{{ block.id }}"
                    class="bl-tab-card-card {% if forloop.first %} active {% endif %} md:hidden [&.active]:grid grid-cols-1 md:grid-cols-3 border border-[#1C5934] rounded-[12px]"
                  >
                    {% if block.settings.image != blank %}
                      {{
                        block.settings.image
                        | image_url: width: 500
                        | image_tag:
                          class: 'w-full rounded-l-[12px] h-full object-cover hidden md:block',
                          sizes: '500px'
                      }}
                    {% endif %}
                    {% if block.settings.image_mobile != blank %}
                      {{
                        block.settings.image_mobile
                        | image_url: width: 500
                        | image_tag:
                          class: 'w-full rounded-t-[12px] h-full object-cover aspect-[4/3] block md:hidden',
                          sizes: '500px'
                      }}
                    {% endif %}

                    <div
                      class="bl-tab-card-mobile-parent group md:col-span-2 flex flex-col gap-2 md:gap-5 md:rounded-r-[12px] max-md:rounded-b-[12px] bg-white p-[10px] md:p-10"
                      style="background-color: {{ block.settings.bgcolor }};"
                    >
                      {% if block.settings.label != blank %}
                        <div
                          class="text-[11px] md:text-[16px] font-bold !leading-tight text-[#084C25] border border-[#084C25] rounded-[100px] px-5 py-1 md:py-2 w-fit"
                        >
                          {{ block.settings.label }}
                        </div>
                      {% endif %}
                      {% if block.settings.heading != blank %}
                        <div
                          class="bl-tab-card-heading text-[20px] md:text-[32px] font-bold !leading-tight text-[#00754A] flex justify-between gap-3"
                          style="color: {{ block.settings.heading_color }};"
                        >
                          <span>{{ block.settings.heading }}</span>
                          <span class="group-[.active]:rotate-180 md:hidden h-fit">
                            <svg
                              width="32"
                              height="32"
                              viewBox="0 0 32 32"
                              fill="none"
                              xmlns="http://www.w3.org/2000/svg"
                            >
                              <path d="M8.5498 11.71C8.45216 11.6124 8.29391 11.6123 8.19629 11.71L7.84277 12.0635C7.74515 12.1611 7.74518 12.3194 7.84277 12.417L15.4893 20.0635C15.5869 20.1611 15.7451 20.1611 15.8428 20.0635L23.4893 12.417C23.5869 12.3194 23.5869 12.1611 23.4893 12.0635L23.1357 11.71C23.0381 11.6123 22.8799 11.6123 22.7822 11.71L15.666 18.8262L8.5498 11.71Z" fill="#25505F" stroke="#25505F"/>
                            </svg>
                          </span>
                        </div>
                      {% endif %}

                      <div class="bl-tab-card-dropdown-content w-full flex flex-col gap-2 md:gap-5">
                        <div class="flex flex-col gap-1 md:gap-2">
                          {% if block.settings.subheading1 != blank %}
                            <div
                              class="text-[16px] md:text-[20px] font-bold !leading-tight text-[#000]"
                              style="color: {{ block.settings.subheading_color }};"
                            >
                              {{ block.settings.subheading1 }}
                            </div>
                          {% endif %}
                          {% if block.settings.description1 != blank %}
                            <div
                              class="text-[16px] md:text-[16px] font-normal !leading-tight text-[#000]"
                              style="color: {{ block.settings.description_color }};"
                            >
                              {{ block.settings.description1 }}
                            </div>
                          {% endif %}
                        </div>

                        <div class="grid md:grid-cols-2 gap-10">
                          <div class="flex flex-col gap-1 md:gap-2">
                            {% if block.settings.subheading2 != blank %}
                              <div
                                class="text-[16px] md:text-[20px] font-bold !leading-tight text-[#000]"
                                style="color: {{ block.settings.subheading_color }};"
                              >
                                {{ block.settings.subheading2 }}
                              </div>
                            {% endif %}
                            {% if block.settings.description2 != blank %}
                              <div
                                class="text-[16px] md:text-[16px] font-normal !leading-tight text-[#000]"
                                style="color: {{ block.settings.description_color }};"
                              >
                                {{ block.settings.description2 }}
                              </div>
                            {% endif %}
                          </div>
                          <div class="flex flex-col gap-1 md:gap-2">
                            {% if block.settings.subheading3 != blank %}
                              <div
                                class="text-[16px] md:text-[20px] font-bold !leading-tight text-[#000]"
                                style="color: {{ block.settings.subheading_color }};"
                              >
                                {{ block.settings.subheading3 }}
                              </div>
                            {% endif %}
                            {% if block.settings.description3 != blank %}
                              <div
                                class="text-[16px] md:text-[16px] font-normal !leading-tight text-[#000]"
                                style="color: {{ block.settings.description_color }};"
                              >
                                {{ block.settings.description3 }}
                              </div>
                            {% endif %}
                          </div>
                        </div>

                        <div class="bg-white rounded-[10px] p-[10px] grid md:grid-cols-4 gap-4">
                          {% if block.settings.icon != blank %}
                            {{
                              block.settings.icon
                              | image_url: width: 200
                              | image_tag: class: 'w-full rounded-[8px] hidden md:block', sizes: '200px'
                            }}
                          {% endif %}
                          <div class="flex flex-col gap-3 md:gap-2 md:col-span-3">
                            {% if block.settings.subheading4 != blank %}
                              <div
                                class="text-[16px] md:text-[20px] font-bold !leading-tight text-[#000]"
                                style="color: {{ block.settings.subheading_color }};"
                              >
                                {{ block.settings.subheading4 }}
                              </div>
                            {% endif %}
                            {% if block.settings.icon_mobile != blank %}
                              {{
                                block.settings.icon_mobile
                                | image_url: width: 400
                                | image_tag: class: 'w-full rounded-[4px] block md:hidden', sizes: '400px'
                              }}
                            {% endif %}
                            {% if block.settings.description4 != blank %}
                              <div
                                class="text-[16px] md:text-[16px] font-normal !leading-tight text-[#000]"
                                style="color: {{ block.settings.description_color }};"
                              >
                                {{ block.settings.description4 }}
                              </div>
                            {% endif %}
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
              {% endcase %}
            {% endfor %}
          </div>
        {% endif %}
      </div>

      {% if section.settings.button_label != blank %}
        <div class="w-full md:w-fit mx-auto">
          <a
            href="{{ section.settings.button_url }}"
            class="new-button--primary"
          >
            {{ section.settings.button_label }}
            {%- render 'icon-arrow-right' -%}
          </a>
          {% if section.settings.btn_bottom_text != blank %}
            <div
              class="text-[14px] md:text-[16px] font-normal !leading-tight text-[#000] {% if section.settings.description_m_center %} max-md:text-center {% endif %} {% if block.settings.description_d_center %} md:text-center {% endif %}"
              style="color: {{ section.settings.btn_bottom_text_color }};"
            >
              {{ section.settings.btn_bottom_text }}
            </div>
          {% endif %}
        </div>
      {% endif %}
    </div>
  </div>
</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const tabs = document.querySelectorAll('.bl-tab-card-tab');
    const cards = document.querySelectorAll('.bl-tab-card-card');

    tabs.forEach((tab) => {
      tab.addEventListener('click', () => {
        const id = tab.getAttribute('data-id');
        tabs.forEach((t) => t.classList.remove('active'));
        tab.classList.add('active');

        cards.forEach((c) => c.classList.remove('active'));
        const match = document.querySelector(`.bl-tab-card-card[data-id="${id}"]`);
        if (match) {
          match.classList.add('active');
        }
      });
    });
  });

  document.addEventListener('DOMContentLoaded', () => {
    const headings = document.querySelectorAll('.bl-tab-card-heading');
    headings.forEach((heading) => {
      heading.addEventListener('click', () => {
        // find nearest parent
        const parent = heading.closest('.bl-tab-card-mobile-parent');

        if (parent) {
          // toggle active class on this parent
          parent.classList.toggle('active');
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "BL Tab Card",
  "settings": [
    {
      "type": "text",
      "id": "section_id",
      "label": "Section ID"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading"
    },
    {
      "type": "checkbox",
      "id": "heading_m_center",
      "label": "Heading Mobile Center",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "heading_d_center",
      "label": "Heading Desktop Center",
      "default": true
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading Color",
      "default": "#121212"
    },
    {
      "type": "richtext",
      "id": "description",
      "label": "Description"
    },
    {
      "type": "checkbox",
      "id": "description_m_center",
      "label": "Description Mobile Center",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "description_d_center",
      "label": "Description Desktop Center",
      "default": false
    },
    {
      "type": "color",
      "id": "description_color",
      "label": "Description Color",
      "default": "#121212"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "image_picker",
      "id": "bg",
      "label": "Background Image"
    },
    {
      "type": "range",
      "id": "border_radius",
      "min": 0,
      "max": 100,
      "step": 1,
      "unit": "px",
      "label": "Border Radius",
      "default": 0
    },
    {
      "type": "checkbox",
      "id": "image_right",
      "label": "Image Right",
      "default": false
    },
    {
      "type": "text",
      "id": "button_label",
      "label": "Button Label"
    },
    {
      "type": "url",
      "id": "button_url",
      "label": "Button URL"
    },
    {
      "type": "richtext",
      "id": "btn_bottom_text",
      "label": "Btn Bottom Text"
    },
    {
      "type": "color",
      "id": "btn_bottom_text_color",
      "label": "Buttom Bottom Text Color",
      "default": "#000"
    },
    {
      "type": "color",
      "id": "bgcolor",
      "label": "Background Color",
      "default": "#ffffff"
    },
    {
      "type": "range",
      "id": "max_width",
      "min": 600,
      "max": 1800,
      "step": 20,
      "unit": "px",
      "label": "Max Width",
      "default": 1200
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Padding Top",
      "default": 72
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Padding Bottom",
      "default": 72
    },
    {
      "type": "range",
      "id": "padding_top_m",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Padding Top (Mobile)",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom_m",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Padding Bottom (Mobile)",
      "default": 36
    }
  ],
  "blocks": [
    {
      "type": "row",
      "name": "Row",
      "settings": [
        {
          "type": "color",
          "id": "bgcolor",
          "label": "Background Color",
          "default": "#F4F4F6"
        },
        {
          "type": "text",
          "id": "label",
          "label": "Label"
        },
        {
          "type": "checkbox",
          "id": "label_m_center",
          "label": "Label Mobile Center",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "label_d_center",
          "label": "Label Desktop Center",
          "default": true
        },
        {
          "type": "color",
          "id": "label_color",
          "label": "Label Color",
          "default": "#00754A"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading"
        },
        {
          "type": "checkbox",
          "id": "heading_m_center",
          "label": "Heading Mobile Center",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "heading_d_center",
          "label": "Heading Desktop Center",
          "default": true
        },
        {
          "type": "color",
          "id": "heading_color",
          "label": "Heading Color",
          "default": "#00754A"
        },
        {
          "type": "richtext",
          "id": "subheading1",
          "label": "Subheading 1"
        },
        {
          "type": "richtext",
          "id": "subheading2",
          "label": "Subheading 2"
        },
        {
          "type": "richtext",
          "id": "subheading3",
          "label": "Subheading 3"
        },
        {
          "type": "richtext",
          "id": "subheading4",
          "label": "Subheading 4"
        },
        {
          "type": "color",
          "id": "subheading_color",
          "label": "Subheading Color",
          "default": "#000"
        },
        {
          "type": "richtext",
          "id": "description1",
          "label": "Description 1"
        },
        {
          "type": "richtext",
          "id": "description2",
          "label": "Description 2"
        },
        {
          "type": "richtext",
          "id": "description3",
          "label": "Description 3"
        },
        {
          "type": "richtext",
          "id": "description4",
          "label": "Description 4"
        },
        {
          "type": "checkbox",
          "id": "description_m_center",
          "label": "Description Mobile Center",
          "default": true
        },
        {
          "type": "checkbox",
          "id": "description_d_center",
          "label": "Description Desktop Center",
          "default": false
        },
        {
          "type": "checkbox",
          "id": "small_description",
          "label": "Description Small",
          "default": false
        },
        {
          "type": "color",
          "id": "description_color",
          "label": "Description Color",
          "default": "#000"
        },
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "image_picker",
          "id": "image_mobile",
          "label": "Image Mobile"
        },
        {
          "type": "image_picker",
          "id": "icon",
          "label": "Icon"
        },
        {
          "type": "image_picker",
          "id": "icon_mobile",
          "label": "Icon Mobile"
        },
        {
          "type": "text",
          "id": "button_label",
          "label": "Button Label"
        },
        {
          "type": "url",
          "id": "button_url",
          "label": "Button URL"
        },
        {
          "type": "richtext",
          "id": "btn_bottom_text",
          "label": "Btn Bottom Text"
        },
        {
          "type": "color",
          "id": "btn_bottom_text_color",
          "label": "Buttom Bottom Text Color",
          "default": "#000"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "BL Tab Card"
    }
  ]
}
{% endschema %}
